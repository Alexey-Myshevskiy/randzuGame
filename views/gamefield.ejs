<!DOCTYPE html>
<html>
<head>
    <title>Новая партия игры</title>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css'/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="/javascripts/canvasHandler.js"></script>
    <script src="/javascripts/howler.min.js"></script>
    <script src="/javascripts/soundMixer.js"></script>
    <script src="/javascripts/grid.min.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.3.7.js"></script>
    <script>
        var socket = io(window.location.origin);
        socket.on('cpu_step', function (data) {
            drawFishka(document.getElementById('field'), data.X, data.Y, 'cpu')
        });
        socket.on('victory', function (data) {
            drawFishka(document.getElementById('field'), data.coords.X, data.coords.Y, 'cpu');
            var content;
            switch (data.winner) {
                case 'cpu':
                    content = "<div class='alert alert-warning' role='alert'><h3>Вы проиграли</h3></div>";
                    break;
                case 'usr':
                    content = "<div class='alert alert-success' role='alert'><h3>Вы выиграли</h3></div>";
                    break;
            }
            document.getElementById('modalContainer').innerHTML = content;
            $('.bs-example-modal-lg').modal('show');
        });
        player.startPlay();
        //----------- control buttons handlers -----------------//
        function stopPlayBtn(element) {
            var Element = element;
            var textElement = Element.text();
            var variants = ['Выключить звук', 'Включить звук'];
            if (textElement.trim() == variants[0]) {
                Element.replaceWith(
                        "<button id='playStop' type='button' class='btn btn-default' onclick='stopPlayBtn($(this))'>" +
                        "<span class='glyphicon glyphicon-volume-up' aria-hidden='true'></span>\t" + variants[1] + "</button>");
                // playlist().getCurrentTrack().pause();
                player.stopPlay();
            }
            else {
                Element.replaceWith(
                        "<button id='playStop' type='button' class='btn btn-default' onclick='stopPlayBtn($(this))'>" +
                        "<span class='glyphicon glyphicon-volume-off' aria-hidden='true'></span>\t" + variants[0] + "</button>");
                //sound.play();
                player.continuePlay();
            }
        }
    </script>
</head>
<body>

<div class="row">
    <div class="col-md-offset-2 col-lg-offset-2 col-sm-offset-1">
        <div class="btn-toolbar col-lg-8 col-mg-8 col-sm-10" role="toolbar" aria-label="...">
            <button type="button" class="btn btn-default">
                <span class="glyphicon glyphicon-pause" aria-hidden="true"></span>
                Пауза
            </button>
            <button id="playStop" type="button" class="btn btn-default" onclick="stopPlayBtn($(this))">
                <span class="glyphicon glyphicon-volume-off" aria-hidden="true"></span>
                Выключить звук
            </button>
            <button type="button" class="btn btn-default">
                <span class="glyphicon glyphicon-flag" aria-hidden="true"></span>
                Сдаться
            </button>
            <button type="button" class="btn btn-default">
                <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                Правила
            </button>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-2 col-mg-2 col-sm-1" style="border: 1px solid red">

    </div>
    <div class="panel panel-info col-lg-8 col-mg-8 col-sm-10">
        <div class="panel-heading">Время партии: 0:0</div>
        <div class="panel-body">
            <canvas id='field' width="751" height="751">
                <!-- Здесь отрисуем игровое поле -->
            </canvas>
        </div>
    </div>
    <div class="col-lg-2 col-mg-2 col-sm-1" style="border: 1px solid red">
        gdfg
    </div>
</div>
<!--                     constraint a modal message -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="strong">RandZU</h4>
                    <div class="modal-body" id="modalContainer">
                        <!-- message -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
